@page "/"
@using QueteDuDragon.Data.Heroes;
@inject NavigationManager NavigationManager

<header>
    <h1>Quête du Dragon</h1>
</header>

<main>
    <div class="game-info">
        <section class="instructions">
            <h2>Fonctionnement du jeu</h2>
            <p>
            
                Bienvenue dans la Quête du Dragon ! Choisissez un héros parmi Guerrier, Mage ou Voleur,
                puis partez à l'aventure. Collectez des objets, améliorez vos compétences et affrontez
                des ennemis redoutables.
                
                <br>
                il y'a deux modes differentes:
                <br/>
                
                

                <br>
                Facile: Collectez des objets jusqu'au 1er Niveau puis Affronter le BossFinal.
                <br/>

                <br>
                Difficile : Collectez des objets, Affronter les monstres, Gagner de l'experience , Affronter le bossFinal avec plus de chances.
                <br/>

                <br>Décidez de jouer en mode facile ou difficile. Bonne chance !<br/>

            

            </p>
        </section>
    </div>

    <aside class="hero-selection">
        <h3>Personnage</h3>
        <form @onsubmit="HandleFormSubmit">
            <label for="hero-name">Nom du personnage :</label>
            <input type="text" id="hero-name" @bind="HeroName" placeholder="Entrez votre nom" required />

            <label for="hero-choice">Choix du héros :</label>
            <select id="hero-choice" @bind="HeroType" required>
                <option value="Warrior">Guerrier</option>
                <option value="Mage">Mage</option>
                <option value="Thief">Voleur</option>
            </select>

            <label for="mode">Mode :</label>
            <select id="mode" @bind="GameMode" required>
                <option value="Facile">Facile</option>
                <option value="Difficile">Difficile</option>
            </select>

            <button type="submit">Commencer l'aventure</button>
        </form>
    </aside>
</main>

<footer>
    <p>&copy; 2025 Quête du Dragon. Tous droits réservés.</p>
</footer>

@if (!string.IsNullOrWhiteSpace(ErrorMessage))
{
    <p style="color: red;">@ErrorMessage</p>
}

@code {
    private string HeroName { get; set; } = string.Empty;
    private string HeroType { get; set; } = "Warrior"; // Valeur par défaut
    private string GameMode { get; set; } = "Facile"; // Valeur par défaut
    private string? ErrorMessage { get; set; }

    private void HandleFormSubmit()
    {
        if (string.IsNullOrWhiteSpace(HeroName))
        {
            ErrorMessage = "Veuillez entrer un nom pour votre héros.";
            return;
        }

        // Création du héros basé sur le type sélectionné
        Hero selectedHero = HeroType switch
        {
            "Warrior" => new Warrior { Name = HeroName },
            "Mage" => new Mage { Name = HeroName },
            "Thief" => new Thief { Name = HeroName },
            _ => throw new InvalidOperationException("Type de héros invalide.")
        };

        selectedHero.InitializeSkills();

        Console.WriteLine($"Héros sélectionné : {HeroName} ({HeroType})");
        Console.WriteLine($"Mode sélectionné : {GameMode}");

        // Rediriger vers la page selon le mode
        if (GameMode == "Facile")
        {
            NavigationManager.NavigateTo("/mode-facile");
        }
        else
        {
            NavigationManager.NavigateTo("/mode-difficile");
        }
    }
}